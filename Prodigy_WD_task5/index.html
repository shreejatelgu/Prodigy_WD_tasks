<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weather App</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>ğŸŒ¤ Simple Weather App</h1>

    <div class="search">
      <input type="text" id="locationInput" placeholder="Enter city name" />
      <button id="searchBtn">Search</button>
      <button id="geoBtn">ğŸ“ Use My Location</button>
    </div>

    <div id="weatherBox" class="weather-box hidden">
      <h2 id="cityName"></h2>
      <p id="temperature"></p>
      <p id="conditions"></p>
      <p id="wind"></p>
    </div>

    <p id="errorMsg" class="error hidden"></p>
  </div>

  <script>
    const searchBtn = document.getElementById("searchBtn");
    const geoBtn = document.getElementById("geoBtn");
    const input = document.getElementById("locationInput");
    const cityName = document.getElementById("cityName");
    const temperature = document.getElementById("temperature");
    const conditions = document.getElementById("conditions");
    const wind = document.getElementById("wind");
    const errorMsg = document.getElementById("errorMsg");
    const weatherBox = document.getElementById("weatherBox");

    searchBtn.addEventListener("click", () => getWeatherByCity(input.value));
    geoBtn.addEventListener("click", getWeatherByLocation);

    async function getWeatherByCity(city) {
      if (!city.trim()) return showError("Please enter a city name.");
      try {
        const geoRes = await fetch(
          `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1`
        );
        const geoData = await geoRes.json();
        if (!geoData.results || geoData.results.length === 0)
          return showError("City not found!");

        const { latitude, longitude, name, country } = geoData.results[0];
        fetchWeather(latitude, longitude, `${name}, ${country}`);
      } catch {
        showError("Unable to fetch weather for that location!");
      }
    }

    function getWeatherByLocation() {
      if (!navigator.geolocation) return showError("Geolocation not supported!");
      navigator.geolocation.getCurrentPosition(
        async (pos) => {
          const { latitude, longitude } = pos.coords;
          fetchWeather(latitude, longitude, "Your Location");
        },
        () => showError("Unable to fetch weather for your location!")
      );
    }

    async function fetchWeather(lat, lon, name) {
      try {
        const res = await fetch(
          `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`
        );
        const data = await res.json();
        if (!data.current_weather) return showError("No weather data found!");

        const weather = data.current_weather;
        cityName.textContent = name;
        temperature.textContent = `ğŸŒ¡ Temperature: ${weather.temperature}Â°C`;
        conditions.textContent = `ğŸ’¨ Windspeed: ${weather.windspeed} km/h`;
        wind.textContent = `ğŸ§­ Direction: ${weather.winddirection}Â°`;

        errorMsg.classList.add("hidden");
        weatherBox.classList.remove("hidden");
      } catch {
        showError("Unable to fetch weather data!");
      }
    }

    function showError(msg) {
      errorMsg.textContent = msg;
      errorMsg.classList.remove("hidden");
      weatherBox.classList.add("hidden");
    }
  </script>
</body>
</html>
